(this["webpackJsonppony-challenge"]=this["webpackJsonppony-challenge"]||[]).push([[0],{20:function(e,t,a){},21:function(e,t,a){},23:function(e,t,a){},29:function(e,t,a){"use strict";a.r(t);var n,r=a(0),c=a(6),s=a.n(c),i=a(7),o=a(3),u=(a(20),a(21),a(1)),l=function(e){var t=e.id,a=e.name,n=e.min,c=e.max,s=e.value,i=e.onChange;return Object(r.useEffect)((function(){s&&function(){var e=document.getElementById(t),a=(e.value-e.min)/(e.max-e.min)*100;e.style.background="linear-gradient(to right, #eeddf1 0%,  #eeddf1 ".concat(a/2,"%, #eeddf1 ").concat(a,"%,  #35023b ").concat(a,"%,  #35023b 100%)")}()}),[s]),Object(u.jsxs)("div",{className:"slider",children:[Object(u.jsx)("label",{htmlFor:t,children:a}),Object(u.jsx)("input",{type:"range",className:"slider__input",id:t,name:a,min:n,max:c,defaultValue:s,onChange:function(e){return i(e.target.value)}}),Object(u.jsx)("label",{children:s})]})},d=(a(23),function(e){var t=e.cell,a=e.width,n=t.walls,r=t.isPony,c=t.isDomokun,s=t.isExit;return Object(u.jsxs)("div",{className:"cell ".concat(n.join(" ")),style:{width:"".concat(70/a,"vmin"),height:"".concat(70/a,"vmin")},children:[r&&Object(u.jsx)("span",{className:"pony"}),c&&Object(u.jsx)("span",{className:"domokun"}),s&&Object(u.jsx)("span",{className:"door"})]})}),p=function(e){var t=e.row,a=e.width;return t.map((function(e,t){return Object(u.jsx)(d,{cell:e,width:a},t)}))},h=function(e){var t=e.data,a=function(e){for(var t=0,a=Object(o.a)(e.size,2),n=a[0],r=a[1],c=[],s=0;s<r;s++){for(var i=[],u=0;u<n;u++){var l={key:t,walls:e.data[t],isPony:t===e.pony[0],isDomokun:t===e.domokun[0],isExit:t===e["end-point"][0]};s===r-1&&l.walls.push("south"),u===n-1&&l.walls.push("east"),i.push(l),t++}c.push(i)}return c}(t);return Object(u.jsx)("div",{className:"maze",onKeyPress:function(e){return console.log(e)},children:a.map((function(e,a){return Object(u.jsx)("div",{className:"row",children:Object(u.jsx)(p,{row:e,width:t.size[0]},a)},a)}))})},j={keyboard:a.p+"static/media/keyboard.0b2ea240.svg",up:a.p+"static/media/up.5854c251.svg",down:a.p+"static/media/down.18785dbf.svg",left:a.p+"static/media/left.c9706021.svg",right:a.p+"static/media/right.e24ccab8.svg"},m=a(9),f=a(4),b=a.n(f),O=a(11),y="https://ponychallenge.trustpilot.com/pony-challenge/maze",v=a(10),_=a(2),g="SET_GAME_OVER",x="SET_GAME_WON",w="RESET_GAME",E={isGameWon:null},k=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:E,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case g:return Object(_.a)(Object(_.a)({},e),{},{isGameWon:!1});case x:return Object(_.a)(Object(_.a)({},e),{},{isGameWon:!0});case w:return Object(_.a)(Object(_.a)({},e),{},{isGameWon:null});default:return e}},N="CREATE_MAZE_REQUEST",z="CREATE_MAZE_SUCCESS",S="CREATE_MAZE_FAILURE",C="GET_MAZE_REQUEST",A="GET_MAZE_SUCCESS",T="GET_MAZE_FAILURE",M="MAKE_MOVE_REQUEST",G="MAKE_MOVE_SUCCESS",L="MAKE_MOVE_FAILURE",R="RESET_MAZE",I={mazeId:null,mazeContent:null,isLoading:!1,error:null},U=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:I,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case N:return Object(_.a)(Object(_.a)({},e),{},{isLoading:!0});case z:return Object(_.a)(Object(_.a)({},e),{},{isLoading:!1,mazeId:t.data});case S:return Object(_.a)(Object(_.a)({},e),{},{isLoading:!1,mazeId:null,error:t.data});case C:return Object(_.a)(Object(_.a)({},e),{},{isLoading:!0});case A:return Object(_.a)(Object(_.a)({},e),{},{isLoading:!1,mazeContent:t.data});case T:return Object(_.a)(Object(_.a)({},e),{},{isLoading:!1,mazeContent:null,error:t.data});case M:return Object(_.a)(Object(_.a)({},e),{},{isLoading:!0});case G:return Object(_.a)(Object(_.a)({},e),{},{isLoading:!1});case L:return Object(_.a)(Object(_.a)({},e),{},{isLoading:!1,error:t.data});case R:return I;default:return e}},P=Object(v.a)({app:k,maze:U}),W=Object(v.b)(P,window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__()),D=function(e){return{type:z,data:e}},V=function(e){return{type:S,data:e}},Z=function(e){return{type:A,data:e}},F=function(e){return{type:T,data:e}},J=function(){return{type:R}},K=function(){var e=Object(O.a)(b.a.mark((function e(t){var a,n,r,c,s;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.width,n=t.height,r=t.difficulty,e.prev=1,W.dispatch({type:N,data:void 0}),e.next=5,fetch("".concat(y),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({"maze-width":parseInt(a),"maze-height":parseInt(n),"maze-player-name":"Twilight Sparkle",difficulty:parseInt(r)})});case 5:return c=e.sent,e.next=8,c.json();case 8:s=e.sent,W.dispatch(D(s.maze_id)),e.next=16;break;case 12:return e.prev=12,e.t0=e.catch(1),W.dispatch(V(e.t0)),e.abrupt("return",new Error(e.t0));case 16:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(t){return e.apply(this,arguments)}}(),X=function(){var e=Object(O.a)(b.a.mark((function e(t){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,W.dispatch({type:C,data:void 0}),e.next=4,fetch("".concat(y,"/").concat(t)).then((function(e){return e.json()})).then((function(e){W.dispatch(Z(e))}));case 4:e.next=10;break;case 6:return e.prev=6,e.t0=e.catch(0),W.dispatch(F(e.t0)),e.abrupt("return",new Error(e.t0));case 10:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}(),Q=function(){var e=Object(O.a)(b.a.mark((function e(t,a){var n,r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,W.dispatch({type:M}),e.next=4,fetch("".concat(y,"/").concat(t),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({direction:a})});case 4:return n=e.sent,e.next=7,n.json();case 7:if("active"!==(r=e.sent).state){e.next=14;break}return e.next=11,X(t);case 11:W.dispatch({type:G}),e.next=16;break;case 14:W.dispatch(J()),"won"===r.state?W.dispatch({type:x}):W.dispatch({type:g});case 16:e.next=22;break;case 18:return e.prev=18,e.t0=e.catch(0),W.dispatch((c=e.t0,{type:L,data:c})),e.abrupt("return",new Error(e.t0));case 22:case"end":return e.stop()}var c}),e,null,[[0,18]])})));return function(t,a){return e.apply(this,arguments)}}(),B=function(e,t){Object(r.useEffect)((function(){if(W.getState().maze.mazeContent){var a=function(a){a.key===e&&t()};return window.addEventListener("keyup",a),function(){return window.removeEventListener("keyup",a)}}}),[t,e])},q=a.p+"static/media/gameOver.d8daa31f.gif",H=a.p+"static/media/gameWon.a4cc3037.gif",Y=a(15),$={south:"north",north:"south",east:"west",west:"east"},ee=[],te=[],ae=function e(t,a,n,r,c){var s=ne(t);for(var i in t===r&&(ee=n,te=c,re()),s)if(!a||s[i]!==$[a]){var o=ce(t,s[i]);if(!n.includes(o)){var u=Object(Y.a)(n),l=Object(Y.a)(c);u.push(o),l.push(s[i]),e(o,s[i],u,r,l)}}},ne=function(e){var t=new Set(Object.keys($)),a=n.data,r=se(e);for(var c in 0===r[0]&&t.delete("north"),0===r[1]&&t.delete("west"),a[e])t.delete(a[e][c]);return oe(r)&&t.delete("south"),ue(r)&&t.delete("east"),Array.from(t)},re=function(){var e=te[0];if(le()){var t=ne(n.pony[0]);e=Object.keys($).filter((function(e){return!t.includes(e)}))[0]}Q(n.maze_id,e)},ce=function(e,t){var a=se(e);switch(t){case"north":return ie([a[0]-1,a[1]]);case"south":return ie([a[0]+1,a[1]]);case"west":return ie([a[0],a[1]-1]);case"east":return ie([a[0],a[1]+1]);default:return a}},se=function(e){return[Math.floor(e/n.size[0]),e%n.size[0]]},ie=function(e){return e[0]*n.size[0]+e[1]},oe=function(e){if(e[0]===n.size[1]-1)return!0;var t=ie([e[0]+1,e[1]]);return!!n.data[t].includes("north")},ue=function(e){if(e[1]===n.size[0]-1)return!0;var t=ie([e[0],e[1]+1]);return!!n.data[t].includes("west")},le=function(){var e=n.domokun[0],t=ee.indexOf(e);if(t>-1&&t<3)return!0;var a=se(ee[1]),r=[];return r.push(ie([a[0]-1,a[1]])),r.push(ie([a[0]+1,a[1]])),r.push(ie([a[0],a[1]-1])),r.push(ie([a[0],a[1]+1])),r.includes(e)},de=Object(m.b)((function(e){return{mazeId:e.maze.mazeId,maze:e.maze.mazeContent,isGameWon:e.app.isGameWon}}),(function(e){return{resetMaze:function(){return e(J())},resetGame:function(){return e({type:w})}}}))((function(e){var t=Object(r.useState)(15),a=Object(o.a)(t,2),c=a[0],s=a[1],d=Object(r.useState)(15),p=Object(o.a)(d,2),m=p[0],f=p[1],b=Object(r.useState)(5),O=Object(o.a)(b,2),y=O[0],v=O[1],_=Object(r.useState)("manual-play"),g=Object(o.a)(_,2),x=g[0],w=g[1],E=e.mazeId,k=e.maze,N=e.resetMaze,z=e.resetGame,S=e.isGameWon;Object(r.useEffect)((function(){return E&&X(E)}),[E]);var C=function(e){return"manual-play"===x&&Q(E,e)};return B("ArrowLeft",(function(){C("west")})),B("ArrowRight",(function(){C("east")})),B("ArrowUp",(function(){C("north")})),B("ArrowDown",(function(){C("south")})),Object(r.useEffect)((function(){"autoplay"===x&&k&&function(e){var t=(n=e).pony[0],a=n["end-point"][0];ae(t,void 0,[t],a,[])}(k)}),[x,k]),Object(u.jsxs)("div",{className:"app",children:[Object(u.jsxs)("aside",Object(i.a)({className:"app__sidebar",children:"app-sidebar"},"children",[Object(u.jsx)("h1",{className:"app__title",children:"Save the pony \ud83e\udd84 "}),Object(u.jsx)("p",{className:"app__description",children:"Twilight Sparkle is in danger. Rescue her from the big bad Domokun!"}),Object(u.jsxs)("section",{className:"app__parameters",children:[Object(u.jsx)(l,{id:"width",name:"width",min:"15",max:"25",value:c,onChange:s}),Object(u.jsx)(l,{id:"height",name:"height",min:"15",max:"25",value:m,onChange:f}),Object(u.jsx)(l,{id:"difficulty",name:"difficulty",min:"0",max:"10",value:y,onChange:v})]}),Object(u.jsx)("section",{className:"app__buttons",children:Object(u.jsx)("button",{className:"app__buttons--play",onClick:E?function(){N(),z(),w("manual-play")}:function(){return K({width:c,height:m,difficulty:y})},children:E?"Reset \u2192":"Play \u21a9\ufe0e"})}),Object(u.jsxs)("form",{className:"app__mode",children:[Object(u.jsx)("input",{type:"radio",value:"manual-play",checked:"manual-play"===x,id:"manual-play",onChange:function(e){return!E&&w(e.target.value)},name:"manual-play"}),Object(u.jsx)("label",{htmlFor:"manual-play",children:"Manual play"}),Object(u.jsx)("input",{type:"radio",value:"autoplay",checked:"autoplay"===x,id:"autoplay",onChange:function(e){return!E&&w(e.target.value)},name:"autoplay"}),Object(u.jsx)("label",{htmlFor:"autoplay",children:"Autoplay"})]}),E&&Object(u.jsx)("section",{className:"app__controls",children:Object(u.jsxs)("p",{className:"app__keyboard-controls",children:["Use"," ",Object(u.jsx)("img",{src:j.keyboard,className:"app__keyboard-controls-icon",width:30,height:30,alt:"arrow keys"})," ","to move the pony."]})})])),Object(u.jsx)("div",{className:"app__maze-container",children:E?k&&Object(u.jsxs)("div",{children:[Object(u.jsx)(h,{data:k,width:c,height:m}),Object(u.jsxs)("p",{className:"app__mouse-controls",children:[Object(u.jsx)("img",{src:j.up,onClick:function(){return C("north")},className:"app__mouse-controls-up",alt:"arrow keys"})," ",Object(u.jsx)("img",{src:j.down,onClick:function(){return C("south")},className:"app__mouse-controls-down",alt:"arrow keys"})," ",Object(u.jsx)("img",{src:j.left,onClick:function(){return C("west")},className:"app__mouse-controls-left",alt:"arrow keys"})," ",Object(u.jsx)("img",{src:j.right,onClick:function(){return C("east")},className:"app__mouse-controls-right",alt:"arrow keys"})," "]})]}):null===S?Object(u.jsx)("p",{className:"app__instructions",children:"Press on 'Play' to create the maze."}):S?Object(u.jsxs)("div",{className:"app__game-won",children:[Object(u.jsx)("img",{src:H,width:400,className:"app__gif",alt:"Game won"}),Object(u.jsx)("p",{children:"Congrats, you saved the pony!"}),Object(u.jsx)("button",{className:"app__buttons--retry",onClick:function(){return K({width:c,height:m,difficulty:y})},children:"Play again"})]}):Object(u.jsxs)("div",{className:"app__game-over",children:[Object(u.jsx)("img",{src:q,className:"app__gif",alt:"Game over"}),Object(u.jsx)("p",{children:"Game over"}),Object(u.jsx)("button",{className:"app__buttons--retry",onClick:function(){return K({width:c,height:m,difficulty:y})},children:"Retry"})]})})]})}));s.a.render(Object(u.jsx)(m.a,{store:W,children:Object(u.jsx)(de,{})}),document.getElementById("root"))}},[[29,1,2]]]);
//# sourceMappingURL=main.b7cf451b.chunk.js.map