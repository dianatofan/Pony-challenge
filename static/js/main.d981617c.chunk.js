(this["webpackJsonppony-challenge"]=this["webpackJsonppony-challenge"]||[]).push([[0],{19:function(e,t,a){},20:function(e,t,a){},22:function(e,t,a){},28:function(e,t,a){"use strict";a.r(t);var n,r=a(0),c=a(6),s=a.n(c),i=a(3),o=(a(19),a(20),a(1)),u=function(e){var t=e.id,a=e.name,n=e.min,c=e.max,s=e.value,i=e.onChange;return Object(r.useEffect)((function(){s&&function(){var e=document.getElementById(t),a=(e.value-e.min)/(e.max-e.min)*100;e.style.background="linear-gradient(to right, #eeddf1 0%,  #eeddf1 ".concat(a/2,"%, #eeddf1 ").concat(a,"%,  #35023b ").concat(a,"%,  #35023b 100%)")}()}),[s]),Object(o.jsxs)("div",{className:"slider",children:[Object(o.jsx)("label",{htmlFor:t,children:a}),Object(o.jsx)("input",{type:"range",className:"slider__input",id:t,name:a,min:n,max:c,defaultValue:s,onChange:function(e){return i(e.target.value)}}),Object(o.jsx)("label",{children:s})]})},l=(a(22),function(e){var t=e.cell,a=e.width,n=t.walls,r=t.isPony,c=t.isDomokun,s=t.isExit;return Object(o.jsxs)("div",{className:"cell ".concat(n.join(" ")),style:{width:"".concat(70/a,"vmin"),height:"".concat(70/a,"vmin")},children:[r&&Object(o.jsx)("span",{className:"pony"}),c&&Object(o.jsx)("span",{className:"domokun"}),s&&Object(o.jsx)("span",{className:"door"})]})}),d=function(e){var t=e.row,a=e.width;return t.map((function(e,t){return Object(o.jsx)(l,{cell:e,width:a},t)}))},p=function(e){var t=e.data,a=function(e){for(var t=0,a=Object(i.a)(e.size,2),n=a[0],r=a[1],c=[],s=0;s<r;s++){for(var o=[],u=0;u<n;u++){var l={key:t,walls:e.data[t],isPony:t===e.pony[0],isDomokun:t===e.domokun[0],isExit:t===e["end-point"][0]};s===r-1&&l.walls.push("south"),u===n-1&&l.walls.push("east"),o.push(l),t++}c.push(o)}return c}(t);return Object(o.jsx)("div",{className:"maze",onKeyPress:function(e){return console.log(e)},children:a.map((function(e,a){return Object(o.jsx)("div",{className:"row",children:Object(o.jsx)(d,{row:e,width:t.size[0]},a)},a)}))})},h={keyboard:a.p+"static/media/keyboard.0b2ea240.svg",up:a.p+"static/media/up.5854c251.svg",down:a.p+"static/media/down.18785dbf.svg",left:a.p+"static/media/left.c9706021.svg",right:a.p+"static/media/right.e24ccab8.svg"},j=a(8),m=a(4),f=a.n(m),b=a(10),O="https://ponychallenge.trustpilot.com/pony-challenge/maze",y=a(9),v=a(2),_="SET_GAME_OVER",g="SET_GAME_WON",x="RESET_GAME",w={isGameWon:null},E=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:w,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case _:return Object(v.a)(Object(v.a)({},e),{},{isGameWon:!1});case g:return Object(v.a)(Object(v.a)({},e),{},{isGameWon:!0});case x:return Object(v.a)(Object(v.a)({},e),{},{isGameWon:null});default:return e}},k="CREATE_MAZE_REQUEST",N="CREATE_MAZE_SUCCESS",z="CREATE_MAZE_FAILURE",S="GET_MAZE_REQUEST",C="GET_MAZE_SUCCESS",A="GET_MAZE_FAILURE",T="MAKE_MOVE_REQUEST",M="MAKE_MOVE_SUCCESS",G="MAKE_MOVE_FAILURE",L="RESET_MAZE",R={mazeId:null,mazeContent:null,isLoading:!1,error:null},I=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:R,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case k:return Object(v.a)(Object(v.a)({},e),{},{isLoading:!0});case N:return Object(v.a)(Object(v.a)({},e),{},{isLoading:!1,mazeId:t.data});case z:return Object(v.a)(Object(v.a)({},e),{},{isLoading:!1,mazeId:null,error:t.data});case S:return Object(v.a)(Object(v.a)({},e),{},{isLoading:!0});case C:return Object(v.a)(Object(v.a)({},e),{},{isLoading:!1,mazeContent:t.data});case A:return Object(v.a)(Object(v.a)({},e),{},{isLoading:!1,mazeContent:null,error:t.data});case T:return Object(v.a)(Object(v.a)({},e),{},{isLoading:!0});case M:return Object(v.a)(Object(v.a)({},e),{},{isLoading:!1});case G:return Object(v.a)(Object(v.a)({},e),{},{isLoading:!1,error:t.data});case L:return R;default:return e}},U=Object(y.a)({app:E,maze:I}),P=Object(y.b)(U,window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__()),W=function(e){return{type:N,data:e}},D=function(e){return{type:z,data:e}},V=function(e){return{type:C,data:e}},Z=function(e){return{type:A,data:e}},F=function(){return{type:L}},J=function(){var e=Object(b.a)(f.a.mark((function e(t){var a,n,r,c,s;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.width,n=t.height,r=t.difficulty,e.prev=1,P.dispatch({type:k,data:void 0}),e.next=5,fetch("".concat(O),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({"maze-width":parseInt(a),"maze-height":parseInt(n),"maze-player-name":"Twilight Sparkle",difficulty:parseInt(r)})});case 5:return c=e.sent,e.next=8,c.json();case 8:s=e.sent,P.dispatch(W(s.maze_id)),e.next=16;break;case 12:return e.prev=12,e.t0=e.catch(1),P.dispatch(D(e.t0)),e.abrupt("return",new Error(e.t0));case 16:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(t){return e.apply(this,arguments)}}(),K=function(){var e=Object(b.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,P.dispatch({type:S,data:void 0}),e.next=4,fetch("".concat(O,"/").concat(t)).then((function(e){return e.json()})).then((function(e){P.dispatch(V(e))}));case 4:e.next=10;break;case 6:return e.prev=6,e.t0=e.catch(0),P.dispatch(Z(e.t0)),e.abrupt("return",new Error(e.t0));case 10:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}(),X=function(){var e=Object(b.a)(f.a.mark((function e(t,a){var n,r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,P.dispatch({type:T}),e.next=4,fetch("".concat(O,"/").concat(t),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({direction:a})});case 4:return n=e.sent,e.next=7,n.json();case 7:if("active"!==(r=e.sent).state){e.next=14;break}return e.next=11,K(t);case 11:P.dispatch({type:M}),e.next=16;break;case 14:P.dispatch(F()),"won"===r.state?P.dispatch({type:g}):P.dispatch({type:_});case 16:e.next=22;break;case 18:return e.prev=18,e.t0=e.catch(0),P.dispatch((c=e.t0,{type:G,data:c})),e.abrupt("return",new Error(e.t0));case 22:case"end":return e.stop()}var c}),e,null,[[0,18]])})));return function(t,a){return e.apply(this,arguments)}}(),Q=function(e,t){Object(r.useEffect)((function(){if(P.getState().maze.mazeContent){var a=function(a){a.key===e&&t()};return window.addEventListener("keyup",a),function(){return window.removeEventListener("keyup",a)}}}),[t,e])},B=a.p+"static/media/gameOver.d8daa31f.gif",q=a.p+"static/media/gameWon.a4cc3037.gif",H=a(14),Y={south:"north",north:"south",east:"west",west:"east"},$=[],ee=[],te=function e(t,a,n,r,c){var s=ae(t);for(var i in t===r&&($=n,ee=c,ne()),s)if(!a||s[i]!==Y[a]){var o=re(t,s[i]);if(!n.includes(o)){var u=Object(H.a)(n),l=Object(H.a)(c);u.push(o),l.push(s[i]),e(o,s[i],u,r,l)}}},ae=function(e){var t=new Set(Object.keys(Y)),a=n.data,r=ce(e);for(var c in 0===r[0]&&t.delete("north"),0===r[1]&&t.delete("west"),a[e])t.delete(a[e][c]);return ie(r)&&t.delete("south"),oe(r)&&t.delete("east"),Array.from(t)},ne=function(){var e=ee[0];if(ue()){var t=ae(n.pony[0]);e=Object.keys(Y).filter((function(e){return!t.includes(e)}))[0]}X(n.maze_id,e)},re=function(e,t){var a=ce(e);switch(t){case"north":return se([a[0]-1,a[1]]);case"south":return se([a[0]+1,a[1]]);case"west":return se([a[0],a[1]-1]);case"east":return se([a[0],a[1]+1]);default:return a}},ce=function(e){return[Math.floor(e/n.size[0]),e%n.size[0]]},se=function(e){return e[0]*n.size[0]+e[1]},ie=function(e){if(e[0]===n.size[1]-1)return!0;var t=se([e[0]+1,e[1]]);return!!n.data[t].includes("north")},oe=function(e){if(e[1]===n.size[0]-1)return!0;var t=se([e[0],e[1]+1]);return!!n.data[t].includes("west")},ue=function(){var e=n.domokun[0],t=$.indexOf(e);if(t>-1&&t<3)return!0;var a=ce($[1]),r=[];return r.push(se([a[0]-1,a[1]])),r.push(se([a[0]+1,a[1]])),r.push(se([a[0],a[1]-1])),r.push(se([a[0],a[1]+1])),r.includes(e)},le=Object(j.b)((function(e){return{mazeId:e.maze.mazeId,maze:e.maze.mazeContent,isGameWon:e.app.isGameWon}}),(function(e){return{resetMaze:function(){return e(F())},resetGame:function(){return e({type:x})}}}))((function(e){var t=Object(r.useState)(15),a=Object(i.a)(t,2),c=a[0],s=a[1],l=Object(r.useState)(15),d=Object(i.a)(l,2),j=d[0],m=d[1],f=Object(r.useState)(5),b=Object(i.a)(f,2),O=b[0],y=b[1],v=Object(r.useState)("manual-play"),_=Object(i.a)(v,2),g=_[0],x=_[1],w=e.mazeId,E=e.maze,k=e.resetMaze,N=e.resetGame,z=e.isGameWon;Object(r.useEffect)((function(){return w&&K(w)}),[w]);var S=function(e){return"manual-play"===g&&X(w,e)};return Q("ArrowLeft",(function(){S("west")})),Q("ArrowRight",(function(){S("east")})),Q("ArrowUp",(function(){S("north")})),Q("ArrowDown",(function(){S("south")})),Object(r.useEffect)((function(){"autoplay"===g&&E&&function(e){var t=(n=e).pony[0],a=n["end-point"][0];te(t,void 0,[t],a,[])}(E)}),[g,E]),Object(o.jsxs)("div",{className:"app",children:[Object(o.jsxs)("aside",{className:"app__sidebar",children:[Object(o.jsx)("h1",{className:"app__title",children:"Save the pony \ud83e\udd84 "}),Object(o.jsx)("p",{className:"app__description",children:"Twilight Sparkle is in danger. Rescue her from the big bad Domokun!"}),Object(o.jsxs)("section",{className:"app__parameters",children:[Object(o.jsx)(u,{id:"width",name:"width",min:"15",max:"25",value:c,onChange:s}),Object(o.jsx)(u,{id:"height",name:"height",min:"15",max:"25",value:j,onChange:m}),Object(o.jsx)(u,{id:"difficulty",name:"difficulty",min:"0",max:"10",value:O,onChange:y})]}),Object(o.jsx)("section",{className:"app__buttons",children:Object(o.jsx)("button",{className:"app__buttons--play",onClick:w?function(){k(),N(),x("manual-play")}:function(){return J({width:c,height:j,difficulty:O})},children:w?"Reset \u2192":"Play \u21a9\ufe0e"})}),Object(o.jsxs)("form",{className:"app__mode",children:[Object(o.jsx)("input",{type:"radio",value:"manual-play",checked:"manual-play"===g,id:"manual-play",onChange:function(e){return!w&&x(e.target.value)},name:"manual-play"}),Object(o.jsx)("label",{htmlFor:"manual-play",children:"Manual play"}),Object(o.jsx)("input",{type:"radio",value:"autoplay",checked:"autoplay"===g,id:"autoplay",onChange:function(e){return!w&&x(e.target.value)},name:"autoplay"}),Object(o.jsx)("label",{htmlFor:"autoplay",children:"Autoplay"})]}),w&&Object(o.jsx)("section",{className:"app__controls",children:Object(o.jsxs)("p",{className:"app__keyboard-controls",children:["Use"," ",Object(o.jsx)("img",{src:h.keyboard,className:"app__keyboard-controls-icon",width:30,height:30,alt:"arrow keys"})," ","to move the pony."]})})]}),Object(o.jsx)("div",{className:"app__maze-container",children:w?E&&Object(o.jsxs)("div",{children:[Object(o.jsx)(p,{data:E,width:c,height:j}),Object(o.jsxs)("p",{className:"app__mouse-controls",children:[Object(o.jsx)("img",{src:h.up,onClick:function(){return S("north")},className:"app__mouse-controls-up",alt:"arrow keys"})," ",Object(o.jsx)("img",{src:h.down,onClick:function(){return S("south")},className:"app__mouse-controls-down",alt:"arrow keys"})," ",Object(o.jsx)("img",{src:h.left,onClick:function(){return S("west")},className:"app__mouse-controls-left",alt:"arrow keys"})," ",Object(o.jsx)("img",{src:h.right,onClick:function(){return S("east")},className:"app__mouse-controls-right",alt:"arrow keys"})," "]})]}):null===z?Object(o.jsx)("p",{className:"app__instructions",children:"Press on 'Play' to create the maze."}):z?Object(o.jsxs)("div",{className:"app__game-won",children:[Object(o.jsx)("img",{src:q,width:400,className:"app__gif",alt:"Game won"}),Object(o.jsx)("p",{children:"Congrats, you saved the pony!"}),Object(o.jsx)("button",{className:"app__buttons--retry",onClick:function(){return J({width:c,height:j,difficulty:O})},children:"Play again"})]}):Object(o.jsxs)("div",{className:"app__game-over",children:[Object(o.jsx)("img",{src:B,className:"app__gif",alt:"Game over"}),Object(o.jsx)("p",{children:"Game over"}),Object(o.jsx)("button",{className:"app__buttons--retry",onClick:function(){return J({width:c,height:j,difficulty:O})},children:"Retry"})]})})]})}));s.a.render(Object(o.jsx)(j.a,{store:P,children:Object(o.jsx)(le,{})}),document.getElementById("root"))}},[[28,1,2]]]);
//# sourceMappingURL=main.d981617c.chunk.js.map